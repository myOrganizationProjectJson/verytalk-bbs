var platform=navigator.platform;var ua=navigator.userAgent;var ios=/iPhone|iPad|iPod/.test(platform)&&ua.indexOf("AppleWebKit")>-1;var andriod=ua.indexOf("Android")>-1;(function(G,E,c,B){var M="virtualMouseBindings",o="virtualTouchID",Q="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),b="clientX clientY pageX pageY screenX screenY".split(" "),A=G.event.mouseHooks?G.event.mouseHooks.props:[],l=G.event.props.concat(A),D={},W=0,J=0,j=0,O=false,F=[],R=false,T=false,Y="addEventListener" in c,X=G(c),h=1,V=0,a;G.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function L(i){while(i&&typeof i.originalEvent!=="undefined"){i=i.originalEvent}return i}function S(z,y){var Ae=z.type,Ad,Ab,Ac,w,x,Aa,s,u,v;z=G.Event(z);z.type=y;Ad=z.originalEvent;Ab=G.event.props;if(Ae.search(/^(mouse|click)/)>-1){Ab=l}if(Ad){for(s=Ab.length,w;s;){w=Ab[--s];z[w]=Ad[w]}}if(Ae.search(/mouse(down|up)|click/)>-1&&!z.which){z.which=1}if(Ae.search(/^touch/)!==-1){Ac=L(Ad);Ae=Ac.touches;x=Ac.changedTouches;Aa=(Ae&&Ae.length)?Ae[0]:((x&&x.length)?x[0]:B);if(Aa){for(u=0,v=b.length;u<v;u++){w=b[u];z[w]=Aa[w]}}}return z}function U(s){var u={},i,t;while(s){i=G.data(s,M);for(t in i){if(i[t]){u[t]=u.hasVirtualBinding=true}}s=s.parentNode}return u}function q(t,s){var i;while(t){i=G.data(t,M);if(i&&(!s||i[s])){return t}t=t.parentNode}return null}function f(){T=false}function p(){T=true}function m(){V=0;F.length=0;R=false;p()}function n(){f()}function g(){Z();W=setTimeout(function(){W=0;m()},G.vmouse.resetTimerDuration)}function Z(){if(W){clearTimeout(W);W=0}}function N(s,u,t){var i;if((t&&t[s])||(!t&&q(u.target,s))){i=S(u,s);G(u.target).trigger(i)}return i}function H(t){var i=G.data(t.target,o);if(!R&&(!V||V!==i)){var s=N("v"+t.type,t);if(s){if(s.isDefaultPrevented()){t.preventDefault()}if(s.isPropagationStopped()){t.stopPropagation()}if(s.isImmediatePropagationStopped()){t.stopImmediatePropagation()}}}}function P(s){var v=L(s).touches,w,u;if(v&&v.length===1){w=s.target;u=U(w);if(u.hasVirtualBinding){V=h++;G.data(w,o,V);Z();n();O=false;var i=L(s).touches[0];J=i.pageX;j=i.pageY;N("vmouseover",s,u);N("vmousedown",s,u)}}}function k(i){if(T){return}if(!O){N("vmousecancel",i,U(i.target))}O=true;g()}function r(u){if(T){return}var i=L(u).touches[0],v=O,s=G.vmouse.moveDistanceThreshold,w=U(u.target);O=O||(Math.abs(i.pageX-J)>s||Math.abs(i.pageY-j)>s);if(O&&!v){N("vmousecancel",u,w)}N("vmousemove",u,w);g()}function K(u){if(T){return}p();var v=U(u.target),i;N("vmouseup",u,v);if(!O){var s=N("vclick",u,v);if(s&&s.isDefaultPrevented()){i=L(u).changedTouches[0];F.push({touchID:V,x:i.clientX,y:i.clientY});R=true}}N("vmouseout",u,v);O=false;g()}function I(i){var s=G.data(i,M),t;if(s){for(t in s){if(s[t]){return true}}}return false}function e(){}function d(s){var i=s.substr(1);return{setup:function(v,t){if(!I(this)){G.data(this,M,{})}var u=G.data(this,M);u[s]=true;D[s]=(D[s]||0)+1;if(D[s]===1){X.bind(i,H)}G(this).bind(i,e);if(Y){D["touchstart"]=(D["touchstart"]||0)+1;if(D["touchstart"]===1){X.bind("touchstart",P).bind("touchend",K).bind("touchmove",r).bind("scroll",k)}}},teardown:function(w,t){--D[s];if(!D[s]){X.unbind(i,H)}if(Y){--D["touchstart"];if(!D["touchstart"]){X.unbind("touchstart",P).unbind("touchmove",r).unbind("touchend",K).unbind("scroll",k)}}var v=G(this),u=G.data(this,M);if(u){u[s]=false}v.unbind(i,e);if(!I(this)){v.removeData(M)}}}}for(var C=0;C<Q.length;C++){G.event.special[Q[C]]=d(Q[C])}if(Y){c.addEventListener("click",function(z){var t=F.length,Ac=z.target,Ab,v,u,s,w,Aa;if(t){Ab=z.clientX;v=z.clientY;a=G.vmouse.clickDistanceThreshold;u=Ac;while(u){for(s=0;s<t;s++){w=F[s];Aa=0;if((u===Ac&&Math.abs(w.x-Ab)<a&&Math.abs(w.y-v)<a)||G.data(u,o)===w.touchID){z.preventDefault();z.stopPropagation();return}}u=u.parentNode}}},true)}})(jQuery,window,document);(function(C,B,D){function A(H,F,E){var G=E.type;E.type=F;C.event.handle.call(H,E);E.type=G}C.event.special.tap={setup:function(){var E=this;var F=C(E);F.on("vmousedown",function(M){if(M.which&&M.which!==1){return false}var G=M.target;var J=M.originalEvent;var K;function L(){clearTimeout(K)}function H(){L();F.off("vclick",I).off("vmouseup",L);C(document).off("vmousecancel",H)}function I(N){H();if(G===N.target){A(E,"tap",N)}return false}F.on("vmouseup",L).on("vclick",I);C(document).on("touchcancel",H);K=setTimeout(function(){A(E,"taphold",C.Event("taphold",{target:G}))},750);return false})}};C.each(("tap").split(" "),function(F,E){C.fn[E]=function(G){return this.on(E,G)}})})(jQuery,this);var page={converthtml:function(){var D=$("div.pg .prev").prop("href");var G=$("div.pg .nxt").prop("href");var C=$("div.pg label span").text().replace(/[^\d]/g,"")||0;var A=$("div.pg input").val()||1;if(!C){D=$("div.pg .pgb a").prop("href")}var E=nextpagehref="";if(D==undefined){E='javascript:;" class="grey'}else{E=D}if(G==undefined){nextpagehref='javascript:;" class="grey'}else{nextpagehref=G}var B="";if(C){B+='<a id="select_a" style="margin:0 2px;padding:1px 0 0 0;border:0;display:inline-block;position:relative;width:100px;height:31px;line-height:27px;background:url('+STATICURL+'/image/mobile/images/pic_select.png) no-repeat;text-align:left;text-indent:20px;">';B+='<select id="dumppage" style="position:absolute;left:0;top:0;height:27px;opacity:0;width:100px;">';for(var F=1;F<=C;F++){B+='<option value="'+F+'" '+(F==A?"selected":"")+">第"+F+"页</option>"}B+="</select>";B+="<span>第"+A+"页</span>"}$("div.pg").removeClass("pg").addClass("page").html('<a href="'+E+'">上一页</a>'+B+'<a href="'+nextpagehref+'">下一页</a>');$("#dumppage").on("change",function(){var H=(D||G);window.location.href=H.replace(/page=\d+/,"page="+$(this).val())})},};var scrolltop={obj:null,init:function(B){scrolltop.obj=B;var A=this.isfixed();B.css("opacity",".618");if(A){B.css("bottom","8px")}else{B.css({"visibility":"visible","position":"absolute"})}$(window).on("resize",function(){if(A){B.css("bottom","8px")}else{B.css("top",($(document).scrollTop()+$(window).height()-40)+"px")}});B.on("tap",function(){$(document).scrollTop($(document).height())});$(document).on("scroll",function(){if(!A){B.css("top",($(document).scrollTop()+$(window).height()-40)+"px")}if($(document).scrollTop()>=100){B.removeClass("bottom").off().on("tap",function(){window.scrollTo("0","1")})}else{B.addClass("bottom").off().on("tap",function(){$(document).scrollTop($(document).height())})}})},isfixed:function(){var C=scrolltop.obj.offset();var B=$(window).scrollTop();var A=document.documentElement.clientHeight;if(C==undefined){return false}if(C.top<B||(C.top-B)>A){return false}else{return true}}};var img={init:function(A){var B=this.errorhandle;$("img").on("load",function(){var C=$(this);C.attr("zsrc",C.attr("src"));if(C.width()<5&&C.height()<10&&C.css("display")!="none"){return B(C,A)}C.css("display","inline");C.css("visibility","visible");if(C.width()>window.innerWidth){C.css("width",window.innerWidth)}C.parent().find(".loading").remove();C.parent().find(".error_text").remove()}).on("error",function(){var C=$(this);C.attr("zsrc",C.attr("src"));B(C,A)})},errorhandle:function(D,A){if(D.attr("noerror")=="true"){return}D.css("visibility","hidden");D.css("display","none");var B=D.parent();B.find(".loading").remove();B.append('<div class="loading" style="background:url('+IMGDIR+"/imageloading.gif) no-repeat center center;width:"+B.width()+"px;height:"+B.height()+'px"></div>');var C=parseInt(D.attr("load"))||0;if(C<3){D.attr("src",D.attr("zsrc"));D.attr("load",++C);return false}if(A){var B=D.parent();B.find(".loading").remove();B.append('<div class="error_text">点击重新加载</div>');B.find(".error_text").one("click",function(){D.attr("load",0).find(".error_text").remove();B.append('<div class="loading" style="background:url('+IMGDIR+"/imageloading.gif) no-repeat center center;width:"+B.width()+"px;height:"+B.height()+'px"></div>');D.attr("src",D.attr("zsrc"))})}return false}};var atap={init:function(){$(".atap").on("tap",function(){var A=$(this);A.css({"background":"#6FACD5","color":"#FFFFFF","font-weight":"bold","text-decoration":"none","text-shadow":"0 1px 1px #3373A5"});return false});$(".atap a").off("click")}};var POPMENU=new Object;var popup={init:function(){var A=this;$(".popup").each(function(C,D){D=$(D);var B=$(D.attr("href"));if(B&&B.attr("popup")){B.css({"display":"none"});D.on("click",function(E){A.open(B)})}});this.maskinit()},maskinit:function(){var A=this;$("#mask").off().on("tap",function(){A.close()})},open:function(F,C,A){this.close();this.maskinit();if(typeof F=="string"){$("#ntcmsg").remove();if(C=="alert"){F='<div class="tip"><dt>'+F+'</dt><dd><input class="button2" type="button" value="确定" onclick="popup.close();"></dd></div>'}else{if(C=="confirm"){F='<div class="tip"><dt>'+F+'</dt><dd><input class="redirect button2" type="button" value="确定" href="'+A+'"><a href="javascript:;" onclick="popup.close();">取消</a></dd></div>'}}$("body").append('<div id="ntcmsg" style="display:none;">'+F+"</div>");F=$("#ntcmsg")}if(POPMENU[F.attr("id")]){$("#"+F.attr("id")+"_popmenu").html(F.html()).css({"height":F.height()+"px","width":F.width()+"px"})}else{F.parent().append('<div class="dialogbox" id="'+F.attr("id")+'_popmenu" style="height:'+F.height()+"px;width:"+F.width()+'px;">'+F.html()+"</div>")}var E=$("#"+F.attr("id")+"_popmenu");var D=(window.innerWidth-E.width())/2;var B=(document.documentElement.clientHeight-E.height())/2;E.css({"display":"block","position":"fixed","left":D,"top":B,"z-index":120,"opacity":1});$("#mask").css({"display":"block","width":"100%","height":"100%","position":"fixed","top":"0","left":"0","background":"black","opacity":"0.2","z-index":"100"});POPMENU[F.attr("id")]=F},close:function(){$("#mask").css("display","none");$.each(POPMENU,function(A,B){$("#"+A+"_popmenu").css("display","none")})}};var dialog={init:function(){$(document).on("click",".dialog",function(){var A=$(this);popup.open('<img src="'+IMGDIR+'/imageloading.gif">');$.ajax({type:"GET",url:A.attr("href")+"&inajax=1",dataType:"xml"}).success(function(B){popup.open(B.lastChild.firstChild.nodeValue);evalscript(B.lastChild.firstChild.nodeValue)}).error(function(){window.location.href=A.attr("href");popup.close()});return false})},};var formdialog={init:function(){$(document).on("click",".formdialog",function(){popup.open('<img src="'+IMGDIR+'/imageloading.gif">');var B=$(this);var A=$(this.form);$.ajax({type:"POST",url:A.attr("action")+"&handlekey="+A.attr("id")+"&inajax=1",data:A.serialize(),dataType:"xml"}).success(function(C){popup.open(C.lastChild.firstChild.nodeValue);evalscript(C.lastChild.firstChild.nodeValue)}).error(function(){window.location.href=B.attr("href");popup.close()});return false})}};var redirect={init:function(){$(document).on("click",".redirect",function(){var A=$(this);popup.close();window.location.href=A.attr("href")})}};var DISMENU=new Object;var display={init:function(){var A=this;$(".display").each(function(C,D){D=$(D);var B=$(D.attr("href"));if(B&&B.attr("display")){B.css({"display":"none"});B.css({"z-index":"102"});DISMENU[B.attr("id")]=B;D.on("click",function(E){if(in_array(E.target.tagName,["A","IMG","INPUT"])){return}A.maskinit();if(B.attr("display")=="true"){B.css("display","block");B.attr("display","false");$("#mask").css({"display":"block","width":"100%","height":"100%","position":"fixed","top":"0","left":"0","background":"transparent","z-index":"100"})}return false})}})},maskinit:function(){var A=this;$("#mask").off().on("touchstart",function(){A.hide()})},hide:function(){$("#mask").css("display","none");$.each(DISMENU,function(A,B){B.css("display","none");B.attr("display","true")})}};var geo={latitude:null,longitude:null,loc:null,errmsg:null,timeout:5000,getcurrentposition:function(){if(!!navigator.geolocation){navigator.geolocation.getCurrentPosition(this.locationsuccess,this.locationerror,{enableHighAcuracy:true,timeout:this.timeout,maximumAge:3000})}},locationerror:function(A){geo.errmsg="error";switch(A.code){case A.TIMEOUT:geo.errmsg="获取位置超时，请重试";break;case A.POSITION_UNAVAILABLE:geo.errmsg="无法检测到您的当前位置";break;case A.PERMISSION_DENIED:geo.errmsg="请允许能够正常访问您的当前位置";break;case A.UNKNOWN_ERROR:geo.errmsg="发生未知错误";break}},locationsuccess:function(A){geo.latitude=A.coords.latitude;geo.longitude=A.coords.longitude;geo.errmsg="";$.ajax({type:"POST",url:"http://maps.google.com/maps/api/geocode/json?latlng="+geo.latitude+","+geo.longitude+"&language=zh-CN&sensor=true",dataType:"json"}).success(function(B){if(B.status=="OK"){geo.loc=B.results[0].formatted_address}}).error(function(){geo.loc=null})}};var pullrefresh={init:function(){var A={};var E=false;var B=null;var C=null;var D=false;$("body").on("touchstart",function(F){F=mygetnativeevent(F);A.startx=F.touches[0].pageX;A.starty=F.touches[0].pageY}).on("touchmove",function(G){G=mygetnativeevent(G);A.curposx=G.touches[0].pageX;A.curposy=G.touches[0].pageY;if(A.curposy-A.starty<0&&!E){return}if(!E&&$(window).scrollTop()<=0){E=true;B=document.createElement("div");B=$(B);B.css({"position":"relative","margin-left":"-85px"});$("body").prepend(B);C=document.createElement("div");C=$(C);C.css({"position":"absolute","height":"30px","top":"-30px","left":"50%"});C.html('<img src="'+STATICURL+'image/mobile/images/icon_arrow.gif" style="vertical-align:middle;margin-right:5px;-moz-transform:rotate(180deg);-webkit-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg);"><span id="refreshtxt">下拉可以刷新</span>');C.find("img").css({"-webkit-transition":"all 0.5s ease-in-out"});B.prepend(C);A.topx=A.curposx;A.topy=A.curposy}if(!E){return}if(E==true){var F=A.curposy-A.topy;if(F>=0&&F<150){B.css({"height":F/2+"px"});C.css({"top":(-30+F/2)+"px"});if(D){C.find("img").css({"-webkit-transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-o-transform":"rotate(180deg)","transform":"rotate(180deg)"});C.find("#refreshtxt").html("下拉可以刷新")}D=false}else{if(F>=150){B.css({"height":F/2+"px"});C.css({"top":(-30+F/2)+"px"});if(!D){C.find("img").css({"-webkit-transform":"rotate(360deg)","-moz-transform":"rotate(360deg)","-o-transform":"rotate(360deg)","transform":"rotate(360deg)"});C.find("#refreshtxt").html("松开可以刷新")}D=true}}}G.preventDefault()}).on("touchend",function(F){if(E==true){if(D){C.html('<img src="'+STATICURL+'image/mobile/images/icon_load.gif" style="vertical-align:middle;margin-right:5px;">正在加载...');C.animate({"top":(-30+75)+"px"},618,"linear");B.animate({"height":"75px"},618,"linear",function(){window.location.reload()});return}}B.remove();B=null;E=false;A={}})}};function mygetnativeevent(A){while(A&&typeof A.originalEvent!=="undefined"){A=A.originalEvent}return A}function evalscript(A){if(A.indexOf("<script")==-1){return A}var D=/<script[^\>]*?>([^\x00]*?)<\/script>/ig;var B=[];while(B=D.exec(A)){var C=/<script[^\>]*?src=\"([^\>]*?)\"[^\>]*?(reload=\"1\")?(?:charset=\"([\w\-]+?)\")?><\/script>/i;var E=[];E=C.exec(B[0]);if(E){appendscript(E[1],"",E[2],E[3])}else{C=/<script(.*?)>([^\x00]+?)<\/script>/i;E=C.exec(B[0]);appendscript("",E[2],E[1].indexOf("reload=")!=-1)}}return A}var safescripts={},evalscripts=[];function appendscript(G,B,A,D){var F=hash(G+B);if(!A&&in_array(F,evalscripts)){return}if(A&&$("#"+F)[0]){$("#"+F)[0].parentNode.removeChild($("#"+F)[0])}evalscripts.push(F);var E=document.createElement("script");E.type="text/javascript";E.id=F;E.charset=D?D:(!document.charset?document.characterSet:document.charset);try{if(G){E.src=G;E.onloadDone=false;E.onload=function(){E.onloadDone=true;JSLOADED[G]=1};E.onreadystatechange=function(){if((E.readyState=="loaded"||E.readyState=="complete")&&!E.onloadDone){E.onloadDone=true;JSLOADED[G]=1}}}else{if(B){E.text=B}}document.getElementsByTagName("head")[0].appendChild(E)}catch(C){}}function hash(B,E){var E=E?E:32;var C=0;var D=0;var A="";filllen=E-B.length%E;for(D=0;D<filllen;D++){B+="0"}while(C<B.length){A=stringxor(A,B.substr(C,E));C+=E}return A}function stringxor(A,G){var B="";var D="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var F=Math.max(A.length,G.length);for(var E=0;E<F;E++){var C=A.charCodeAt(E)^G.charCodeAt(E);B+=D.charAt(C%52)}return B}function in_array(B,A){if(typeof B=="string"||typeof B=="number"){for(var C in A){if(A[C]==B){return true}}}return false}function isUndefined(A){return typeof A=="undefined"?true:false}function setcookie(A,D,C,E,F,B){if(D==""||C<0){D="";C=-2592000}if(C){var G=new Date();G.setTime(G.getTime()+C*1000)}F=!F?cookiedomain:F;E=!E?cookiepath:E;document.cookie=escape(cookiepre+A)+"="+escape(D)+(G?"; expires="+G.toGMTString():"")+(E?"; path="+E:"/")+(F?"; domain="+F:"")+(B?"; secure":"")}function getcookie(A,D){A=cookiepre+A;var B=document.cookie.indexOf(A);var E=document.cookie.indexOf(";",B);if(B==-1){return""}else{var C=document.cookie.substring(B+A.length+1,(E>B?E:document.cookie.length));return !D?unescape(C):C}}$(document).ready(function(){if($("div.pg").length>0){page.converthtml()}if($(".scrolltop").length>0){scrolltop.init($(".scrolltop"))}if($("img").length>0){img.init(1)}if($(".popup").length>0){popup.init()}if($(".display").length>0){display.init()}if($(".atap").length>0){atap.init()}if($(".pullrefresh").length>0){pullrefresh.init()}dialog.init();formdialog.init();redirect.init()});